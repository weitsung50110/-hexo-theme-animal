<article class="post">
  <h1><%= page.title %></h1>
  <!-- <p class="post-date"><%- __('post.date') %><%= page.date %></p> -->
  <p class="post-date"><%- __('post.date') %><%= moment(page.date).tz('Asia/Taipei').format('YYYY-MM-DD HH:mm:ss') %></p>
  <p class="post-author"><%- __('post.author') %><%= page.author %></p>
  <% if (page.tags && page.tags.length > 0 || page.categories && page.categories.length > 0) { %>
    <div class="post-meta">
      <% if (page.tags && page.tags.length > 0) { %>
        <div class="post-tags">
          <span><%- __('menu.tags') %>:</span>
          <ul>
            <% page.tags.forEach(function(tag) { %>
              <li><a href="<%= tag.permalink %>"><%= tag.name %></a></li>
            <% }); %>
          </ul>
        </div>
      <% } %>

      <% if (page.categories && page.categories.length > 0) { %>
        <div class="post-categories">
          <span><%- __('menu.categories') %>:</span>
          <ul>
            <% page.categories.forEach(function(category) { %>
              <li><a href="<%= category.permalink %>"><%= category.name %></a></li>
            <% }); %>
          </ul>
        </div>
      <% } %>
    </div>
  <% } %>
  <% if (page.excerpt) { %>
      <div class="excerpt">
          <p><%= page.excerpt %></p>
      </div>
  <% } %>

  <!-- 目錄容器 -->
  <div class="article-container">
    <div class="article-content">
      <%- page.content %>
    </div>
    <div id="toc" class="toc">
      <ul></ul>
    </div>
  </div>
  
  <button id="toc-toggle" class="toc-toggle-btn">目錄</button>

  <script>
      document.addEventListener('DOMContentLoaded', function() {
          const codeBlocks = document.querySelectorAll('pre code');
          codeBlocks.forEach(block => {
              const button = document.createElement('button');
              button.textContent = 'Copy';
              button.className = 'copy-button';
              block.parentElement.style.position = 'relative';
              block.parentElement.appendChild(button);

              button.addEventListener('click', () => {
                  const range = document.createRange();
                  range.selectNode(block);
                  window.getSelection().removeAllRanges();
                  window.getSelection().addRange(range);
                  document.execCommand('copy');
                  window.getSelection().removeAllRanges();
                  // alert('Code copied to clipboard!');
              });
          });
      });

      document.addEventListener('DOMContentLoaded', function() {
        const tables = document.querySelectorAll('article table');
        tables.forEach(table => {
          const container = document.createElement('div');
          container.className = 'table-container';
          table.parentNode.insertBefore(container, table);
          container.appendChild(table);
        });
      });
  </script>
</article>
